<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TEST ANIM</title>
    <script type="text/javascript" src="../dist/humble-render.js"></script>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
        }

        #box {
            width: 900px;
            height: 500px;
            margin: 0 auto;
            border: 1px dashed darkcyan;
            position: relative;
        }

        #can {
            position: absolute;
            z-index: -1;
            width: 900px;
            height: 500px;
        }
    </style>
</head>

<body>
    <div id="box">
        <canvas id="can" width="900" height="500"> </canvas>
    </div>
    <script type="text/javascript">
        let main = document.querySelector("#box");
        let hr = HumbleRender.init(main);
        let colors = [["#E27474", "yellow"], ["#FD8424", 'yellow'], ["#2084C8", 'yellow'], ["#FED66B", 'yellow']];
        let str = '第一行\n第二行\n第三行\n第四行';

        let arcList = [];
        // for (let i = 0; i < 3; i++) {
        //     drawArc(i);
        // }

        //实时获取渐变坐标
        function gradient(endRad, r, cx, cy, i) {
            let start_rad = 0;
            let end_rad = endRad
            let start_pos = {
                x: 0,
                y: 0
            };
            let end_pos = {
                x: 0,
                y: 0
            };
            start_pos.x = Math.cos(start_rad) * r + cx;
            start_pos.y = Math.sin(start_rad) * r + cy;
            end_pos.x = Math.cos(end_rad) * r + cx;
            end_pos.y = Math.sin(end_rad) * r + cy;

            let grd = new HumbleRender.LinearGradient(start_pos.x, start_pos.y, end_pos.x, end_pos.y);
            grd.addColorStop(0, colors[i][0]);
            grd.addColorStop(1, colors[i][1]);
            return grd;
        }

        function drawArc(i) {
            //背景圆环
            let circle = new HumbleRender.Circle({
                shape: {
                    cx: 150 + i * 230,
                    cy: 200,
                    r: 100
                },
                style: {
                    fill: "rgba(0,0,0,0)",
                    stroke: "rgba(0, 0, 0, 0.1)",
                    lineWidth: 2
                }
            });
            hr.add(circle);

            let cx = 150 + i * 230;
            let cy = 200;
            let r = 100;
            let arc = new HumbleRender.Arc({
                shape: {
                    cx: cx,
                    cy: cy,
                    r: r,
                    startAngle: 0,
                    endAngle: 0,
                    clockwise: true
                },
                style: {
                    lineWidth: 20
                }
            });


            hr.add(arc);
            arc.animate("shape")
                .during(() => { //每一帧，回调获取，当前弧度变化，重置渐变色
                    //    console.log(arc.shape.endAngle);
                    let grd = gradient(arc.shape.endAngle, r, cx, cy, i);
                    arc.attr({
                        style: {
                            stroke: grd
                        }
                    });
                })
                .when(1000, { endAngle: (Math.PI * (i * 35 + 200)) / 180 })
                .done(() => {
                    arc.attr({
                        style: {
                            text: str,
                            textFill: 'red',
                            fontSize: 14,
                            textLineHeight:30,
                            fontFamily: 'HeiTi',
                            fontStyle: 'normal',
                            fontWeight: 'normal',
                            textAlign: 'left',
                            textPadding: [0, 0, 0, 0]
                        }
                    })
                })
                .start();
        }

        

        //多边形
        let Polygon = new HumbleRender.Polygon({
            style: {
                fill: 'red',
                
            },
            shape: {
                points: [[450, 300],[500, 300], [550, 350], [500, 400], [450, 400]],    //坐标集合
                smooth:0.2,
                // smoothConstraint: [[450, 300],[550, 400]]
            }
        })
        hr.add(Polygon);


        [
  [
    67.2399917602539,
    101.25
  ],
  [
    119.86399322509764,
    147.08333333333334
  ],
  [
    172.4879946899414,
    78.33333333333333
  ],
  [
    225.11199615478515,
    55.41666666666667
  ],
  [
    277.73599761962885,
    124.16666666666666
  ],
  [
    330.35999908447263,
    170
  ],
  [
    330.35999908447263,
    170
  ],
  [
    67.2399917602539,
    170
  ]
]

    </script>
</body>

</html>
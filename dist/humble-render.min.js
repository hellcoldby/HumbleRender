!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t=t||self,e(t.HumbleRneder={}))}(this,function(t){"use strict";function e(){return ct++}function i(t,e,i,s,a,o){let h=t._handle_map;if("function"==typeof i&&(a=s,s=i,i=null),!s||!e)return t;i=n(t,i),h[e]||(h[e]=[]);for(let i=0;i<h[e].length;i++)if(h[e][i].h===s)return t;let l={fn:s,one:o,query:i,ctx:a||t,callAtLast:s.qrEventfulCallAtLast},u=h[e].length-1,c=h[e][u];return c&&c.callAtLast?h[e].splice(u,0,l):h[e].push(l),r(t,e),t}function n(t,e){let i=t._$eventProcessor;return null!=e&&i&&i.normalizeQuery&&(e=i.normalizeQuery(e)),e}function r(t,e){let i=t._$eventProcessor;i&&i.afterListenerChanged&&i.afterListenerChanged(e)}function s(t){for(var e=0;t>=dt;)e|=1&t,t>>=1;return t+e}function a(t,e,i,n){var r=e+1;if(r===i)return 1;if(n(t[r++],t[e])<0){for(;r<i&&n(t[r],t[r-1])<0;)r++;o(t,e,r)}else for(;r<i&&n(t[r],t[r-1])>=0;)r++;return r-e}function o(t,e,i){for(i--;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}function h(t,e,i,n,r){for(n===e&&n++;n<i;n++){for(var s,a=t[n],o=e,h=n;o<h;)r(a,t[s=o+h>>>1])<0?h=s:o=s+1;var l=n-o;switch(l){case 3:t[o+3]=t[o+2];case 2:t[o+2]=t[o+1];case 1:t[o+1]=t[o];break;default:for(;l>0;)t[o+l]=t[o+l-1],l--}t[o]=a}}function l(t,e,i,n,r,s){var a=0,o=0,h=1;if(s(t,e[i+r])>0){for(o=n-r;h<o&&s(t,e[i+r+h])>0;)a=h,(h=1+(h<<1))<=0&&(h=o);h>o&&(h=o),a+=r,h+=r}else{for(o=r+1;h<o&&s(t,e[i+r-h])<=0;)a=h,(h=1+(h<<1))<=0&&(h=o);h>o&&(h=o);var l=a;a=r-h,h=r-l}for(a++;a<h;){var u=a+(h-a>>>1);s(t,e[i+u])>0?a=u+1:h=u}return h}function u(t,e,i,n,r,s){var a=0,o=0,h=1;if(s(t,e[i+r])<0){for(o=r+1;h<o&&s(t,e[i+r-h])<0;)a=h,(h=1+(h<<1))<=0&&(h=o);h>o&&(h=o);var l=a;a=r-h,h=r-l}else{for(o=n-r;h<o&&s(t,e[i+r+h])>=0;)a=h,(h=1+(h<<1))<=0&&(h=o);h>o&&(h=o),a+=r,h+=r}for(a++;a<h;){var u=a+(h-a>>>1);s(t,e[i+u])<0?h=u:a=u+1}return h}function c(t,e){function i(t,e){h[d]=t,c[d]=e,d+=1}function n(){for(;d>1;){var t=d-2;if(t>=1&&c[t-1]<=c[t]+c[t+1]||t>=2&&c[t-2]<=c[t]+c[t-1])c[t-1]<c[t+1]&&t--;else if(c[t]>c[t+1])break;s(t)}}function r(){for(;d>1;){var t=d-2;t>0&&c[t-1]<c[t+1]&&t--,s(t)}}function s(i){var n=h[i],r=c[i],s=h[i+1],f=c[i+1];c[i]=r+f,i===d-3&&(h[i+1]=h[i+2],c[i+1]=c[i+2]),d--;var p=u(t[s],t,n,r,0,e);n+=p,0!=(r-=p)&&0!==(f=l(t[n+r-1],t,s,f,f-1,e))&&(r<=f?a(n,r,s,f):o(n,r,s,f))}function a(i,n,r,s){var a=0;for(a=0;a<n;a++)p[a]=t[i+a];var o=0,h=r,c=i;if(t[c++]=t[h++],0!=--s){if(1===n){for(a=0;a<s;a++)t[c+a]=t[h+a];return void(t[c+s]=p[o])}for(var d,_,g,y=f;;){d=0,_=0,g=!1;do{if(e(t[h],p[o])<0){if(t[c++]=t[h++],_++,d=0,0==--s){g=!0;break}}else if(t[c++]=p[o++],d++,_=0,1==--n){g=!0;break}}while((d|_)<y);if(g)break;do{if(0!==(d=u(t[h],p,o,n,0,e))){for(a=0;a<d;a++)t[c+a]=p[o+a];if(c+=d,o+=d,(n-=d)<=1){g=!0;break}}if(t[c++]=t[h++],0==--s){g=!0;break}if(0!==(_=l(p[o],t,h,s,0,e))){for(a=0;a<_;a++)t[c+a]=t[h+a];if(c+=_,h+=_,0==(s-=_)){g=!0;break}}if(t[c++]=p[o++],1==--n){g=!0;break}y--}while(d>=pt||_>=pt);if(g)break;y<0&&(y=0),y+=2}if((f=y)<1&&(f=1),1===n){for(a=0;a<s;a++)t[c+a]=t[h+a];t[c+s]=p[o]}else{if(0===n)throw new Error;for(a=0;a<n;a++)t[c+a]=p[o+a]}}else for(a=0;a<n;a++)t[c+a]=p[o+a]}function o(i,n,r,s){var a=0;for(a=0;a<s;a++)p[a]=t[r+a];var o=i+n-1,h=s-1,c=r+s-1,d=0,_=0;if(t[c--]=t[o--],0!=--n){if(1===s){for(_=1+(c-=n),d=1+(o-=n),a=n-1;a>=0;a--)t[_+a]=t[d+a];return void(t[c]=p[h])}for(var g=f;;){var y=0,m=0,v=!1;do{if(e(p[h],t[o])<0){if(t[c--]=t[o--],y++,m=0,0==--n){v=!0;break}}else if(t[c--]=p[h--],m++,y=0,1==--s){v=!0;break}}while((y|m)<g);if(v)break;do{if(0!=(y=n-u(p[h],t,i,n,n-1,e))){for(n-=y,_=1+(c-=y),d=1+(o-=y),a=y-1;a>=0;a--)t[_+a]=t[d+a];if(0===n){v=!0;break}}if(t[c--]=p[h--],1==--s){v=!0;break}if(0!=(m=s-l(t[o],p,0,s,s-1,e))){for(s-=m,_=1+(c-=m),d=1+(h-=m),a=0;a<m;a++)t[_+a]=p[d+a];if(s<=1){v=!0;break}}if(t[c--]=t[o--],0==--n){v=!0;break}g--}while(y>=pt||m>=pt);if(v)break;g<0&&(g=0),g+=2}if((f=g)<1&&(f=1),1===s){for(_=1+(c-=n),d=1+(o-=n),a=n-1;a>=0;a--)t[_+a]=t[d+a];t[c]=p[h]}else{if(0===s)throw new Error;for(d=c-(s-1),a=0;a<s;a++)t[d+a]=p[a]}}else for(d=c-(s-1),a=0;a<s;a++)t[d+a]=p[a]}var h,c,f=pt,d=0;t.length;var p=[];h=[],c=[],this.mergeRuns=n,this.forceMergeRuns=r,this.pushRun=i}function f(t,e,i,n){i||(i=0),n||(n=t.length);var r=n-i;if(!(r<2)){var o=0;if(r<dt)return o=a(t,i,n,e),void h(t,i,n,i+o,e);var l=new c(t,e),u=s(r);do{if((o=a(t,i,n,e))<u){var f=r;f>u&&(f=u),h(t,i,i+f,i+o,e),o=f}l.pushRun(i,o),l.mergeRuns(),r-=o,i+=o}while(0!==r);l.forceMergeRuns()}}function d(t,i,n,r){let s=document.createElement("canvas");return null!=t&&void 0!=t||(t=e()),s.setAttribute("data-qr-dom-id",t),null==i||void 0==i||null==n||void 0==n?s:(s.style&&(s.style.position="absolute",s.style.left=0,s.style.top=0,s.style.width=i+"px",s.style.height=n+"px"),null==r||void 0==r?s:(s.width=i*r,s.height=n*r,s))}function p(t){return t||(t=d()),t.getContext("2d")}function _(t,e){let i=document.createElement("div");return i.style.cssText=[`position: relative`,`width: ${t}px`,`height: ${e}px`,`padding: 0`,`margin: 0`,`border-width: 0`,`background: none`].join(";")+";",i}function g(t,e,i){if(i&&e in i)return parseFloat(i[e]);{let i=t.currentStyle?t.currentStyle[e]:getComputedStyle(t,!1)[e];return parseInt(i,10)}}function y(t,e){let i=new Mt(t,e);return bt[i.id]=i,i}function m(t){t&&t.dispose()}function v(t,e){let i,n,r,s,a=e.x,o=e.y,h=e.width,l=e.height,u=e.r;if(h<0&&(a+=h,h=-h),l<0&&(o+=l,l=-l),"number"==typeof u)i=n=r=s=u;else if(u instanceof Array)switch(u.length){case 1:i=n=r=s=u[0];break;case 2:i=r=u[0],n=s=u[2];break;case 3:i=u[0],n=s=u[1],r=u[2];break;default:i=u[0],n=u[1],r=u[2],s=u[4]}else i=n=r=s=0;let c;i+n>h&&(i*=h/(c=i+n),n*=h/c),r+s>h&&(r*=h/(c=r+s),s*=h/c),n+r>l&&(n*=l/(c=n+r),r*=l/c),i+s>l&&(i*=l/(c=i+s),s*=l/c),t.moveTo(a+i,o),t.lineTo(a+h-n,o),0!==n&&t.arc(a+h-n,o+n,n,-Math.PI/2,0),t.lineTo(a+h,o+l-r),0!==r&&t.arc(a+h-r,o+l-r,r,0,Math.PI/2),t.lineTo(a+s,o+l),0!==s&&t.arc(a+s,o+l-s,s,Math.PI/2,Math.PI),t.lineTo(a,o+i),0!==i&&t.arc(a+i,o+i,i,Math.PI,1.5*Math.PI)}function x(t){return t=Math.round(t),t<0?0:t>255?255:t}function w(t){return t<0?0:t>1?1:t}function b(t){return x(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100*255:parseInt(t,10))}function k(t){return w(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100:parseFloat(t))}function M(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function I(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}function O(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function T(t,e){Dt&&O(Dt,e),Dt=At.put(t,Dt||e.slice())}function C(t,e){if(t){e=e||[];var i=At.get(t);if(i)return O(e,i);var n=(t+="").replace(/ /g,"").toLowerCase();if(n in St)return O(e,St[n]),T(t,e),e;if("#"!==n.charAt(0)){var r=n.indexOf("("),s=n.indexOf(")");if(-1!==r&&s+1===n.length){var a=n.substr(0,r),o=n.substr(r+1,s-(r+1)).split(","),h=1;switch(a){case"rgba":if(4!==o.length)return void I(e,0,0,0,1);h=k(o.pop());case"rgb":return 3!==o.length?void I(e,0,0,0,1):(I(e,b(o[0]),b(o[1]),b(o[2]),h),T(t,e),e);case"hsla":return 4!==o.length?void I(e,0,0,0,1):(o[3]=k(o[3]),P(o,e),T(t,e),e);case"hsl":return 3!==o.length?void I(e,0,0,0,1):(P(o,e),T(t,e),e);default:return}}I(e,0,0,0,1)}else{if(4===n.length)return(l=parseInt(n.substr(1),16))>=0&&l<=4095?(I(e,(3840&l)>>4|(3840&l)>>8,240&l|(240&l)>>4,15&l|(15&l)<<4,1),T(t,e),e):void I(e,0,0,0,1);if(7===n.length){var l=parseInt(n.substr(1),16);return l>=0&&l<=16777215?(I(e,(16711680&l)>>16,(65280&l)>>8,255&l,1),T(t,e),e):void I(e,0,0,0,1)}}}}function P(t,e){var i=(parseFloat(t[0])%360+360)%360/360,n=k(t[1]),r=k(t[2]),s=r<=.5?r*(n+1):r+n-r*n,a=2*r-s;return e=e||[],I(e,x(255*M(a,s,i+1/3)),x(255*M(a,s,i)),x(255*M(a,s,i-1/3)),1),4===t.length&&(e[3]=t[3]),e}function S(t){let e=typeof t;return"function"===e||!!t&&"object"===e}function A(t){return"[object String]"===Object.prototype.toString.call(t)}function D(t){return!isNaN(parseFloat(t))&&isFinite(t)}function L(t){return Object.prototype.toString.call(t)}function F(t){if(!t||"object"!=typeof t)return t;let e=t;if("[object Array]"===L(t)){e=[];for(let i=0;i<t.length;i++)e[i]=F(t[i])}if("[object Object"===L(t)){e={};for(let i in t)e[i]=F(t[i])}return e}function R(t,e,i){if(!S(t)||!S(e))return i?F(e):t;for(let n in e){let r=e[n],s=t[n];"[object Object]"===L(r)&&"[object Object]"===L(s)?R(s,r,i):!i&&n in t||(t[n]=F(e[n]))}return t}function q(t,e,i){let n=new e(i);for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}function E(t,e,i=[]){for(let n in e)if(e.hasOwnProperty(n)){if(i&&i.length&&-1!==i.indexOf(n))continue;t[n]=e[n]}return t}function B(){let t=arguments[arguments.length-1],e=arguments.length,i=!1;"boolean"==typeof t&&(i=t,e-=1);let n=arguments[0],r=1,s=null,a=[];for(r;r<e;r++)s=arguments[r],(a=Object.getOwnPropertyNames(s)).length&&a.forEach(function(t){"constructor"!==t&&"prototype"!==t&&s.hasOwnProperty(t)&&(i?null!=s[t]:!1===n.hasOwnProperty(t))&&(n[t]=s[t])});return n}function z(t){if(t&&"string"!=typeof t)return"number"==typeof t.length}function j(t){let e=t[t.length-1].value;return z(e&&e[0])?2:1}function N(t,e,i){if(t===e)return!0;let n=t.length;if(n!==e.length)return!1;if(1===i){for(let i=0;i<n;i++)if(t[i]!==e[i])return!1}else{let i=t[0].length;for(let r=0;r<n;r++)for(let n=0;n<i;n++)if(t[r][n]!==e[r][n])return!1}return!0}function H(t,e,i){let n=t.length,r=e.length;if(n!==r){let s=n>r;if(s)t.length=r;else for(let s=n;s<r;s++)t.push(1===i?e[s]:Array.prototype.slice.call(e[s]))}let s=t[0]&&t[0].length;for(var a=0;a<t.length;a++)if(1===i)isNaN(t[a])&&(t[a]=e[a]);else for(var o=0;o<s;o++)isNaN(t[a][o])&&(t[a][o]=e[a][o])}function W(t,e,i){return i>.5?e:t}function G(t,e,i,n,r){var s=t.length;if(s){if(1===r)for(o=0;o<s;o++)n[o]=Q(t[o],e[o],i);else{var a=t[0].length;if(!a)return;for(var o=0;o<s;o++){if(void 0===n[o])return;for(var h=0;h<a;h++)n[o][h]=Q(t[o][h],e[o][h],i)}}return n}}function Q(t,e,i){return(e-t)*i+t}function V(t,e,i,n,r,s,a){var o=.5*(i-t),h=.5*(n-e);return(2*(e-i)+o+h)*a+(-3*(e-i)-2*o-h)*s+o*r+e}function X(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function Y(t,e,i,n,r,s,a,o,h){var l=t.length;if(1===h)for(c=0;c<l;c++)o[c]=V(t[c],e[c],i[c],n[c],r,s,a);else for(var u=t[0].length,c=0;c<l;c++)for(var f=0;f<u;f++)o[c][f]=V(t[c][f],e[c][f],i[c][f],n[c][f],r,s,a)}function K(){let t=new Lt(6);return U(t),t}function U(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Z(t,e,i){var n=i[0],r=i[1];return t[0]=e[0]*n,t[1]=e[1]*r,t[2]=e[2]*n,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*r,t}function $(t,e,i){var n=e[0],r=e[2],s=e[4],a=e[1],o=e[3],h=e[5],l=Math.sin(i),u=Math.cos(i);return t[0]=n*u+a*l,t[1]=-n*l+a*u,t[2]=r*u+o*l,t[3]=-r*l+u*o,t[4]=u*s+l*h,t[5]=u*h-l*s,t}function J(t,e){var i=e[0],n=e[2],r=e[4],s=e[1],a=e[3],o=e[5],h=i*a-s*n;return h?(h=1/h,t[0]=a*h,t[1]=-s*h,t[2]=-n*h,t[3]=i*h,t[4]=(n*o-a*r)*h,t[5]=(s*r-i*o)*h,t):null}function tt(t={}){this.origin=t.origin?t.origin:[0,0],this.rotation=t.rotation?t.rotation:0,this.position=t.position?t.position:[0,0],this.scale=t.scale?t.scale:[1,1],this.skew=t.skew?t.skew:[0,0],this.globalScaleRatio=1}function et(t){return t>Ft||t<-Ft}function it(t){B(this,t,!1)}function nt(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null}function rt(t,e,i){var n=i&&i.lineWidth;if(e&&n){var r=e.x1,s=e.x2,a=e.y1,o=e.y2;Math.round(2*r)===Math.round(2*s)?t.x1=t.x2=st(r,n,!0):(t.x1=r,t.x2=s),Math.round(2*a)===Math.round(2*o)?t.y1=t.y2=st(a,n,!0):(t.y1=a,t.y2=o)}}function st(t,e,i){var n=Math.round(2*t);return(n+Math.round(e))%2==0?n/2:(n+(i?1:-1))/2}function at(t,e){var i=new ne(2);return null==t&&(t=0),null==e&&(e=0),i[0]=t,i[1]=e,i}function ot(t,e,i,n,r,s){var a=(e-t)*r+t,o=(i-e)*r+e,h=(n-i)*r+i,l=(o-a)*r+a,u=(h-o)*r+o,c=(u-l)*r+l;s[0]=t,s[1]=a,s[2]=l,s[3]=c,s[4]=c,s[5]=u,s[6]=h,s[7]=n}function ht(t,e,i,n,r){var s=(e-t)*n+t,a=(i-e)*n+e,o=(a-s)*n+s;r[0]=t,r[1]=s,r[2]=o,r[3]=o,r[4]=a,r[5]=i}let lt={};var ut=lt=wx&&"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?{browser:{},os:{},node:!1,wxa:!0,canvasSupported:!0,svgSupported:!1,touchEventsSupported:!0,domSupported:!1}:"undefined"==typeof document&&"undefined"!=typeof self?{browser:{},os:{},node:!1,worker:!0,canvasSupported:!0,domSupported:!1}:"undefined"==typeof navigator?{browser:{},os:{},node:!0,worker:!1,canvasSupported:!0,svgSupported:!0}:function(t){let e={},i={},n=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s[\d.]+/)||t.match(/Trident\/.+?rv:(([\d.]+))/),s=t.match(/Edge\/([\d.]+)/),a=/micromessenger/i.test(t);return n&&(i.firefox=!0,i.version=n[1]),r&&(i.ie=!0,i.version=r[1]),s&&(i.edge=!0,i.version=s[1]),a&&(i.weChat=!0),{browser:i,os:e,node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!i.ie&&!i.edge,pointerEventsSupported:"onpointerdown"in window&&(i.edge||i.ie&&i.version>=11),domSupported:"undefined"!=typeof document}}(navigator.userAgent);let ct=2311;class ft{constructor(t){this._handle_map={},this._eventProcessor=t}on(t,e,n,r){return i(this,t,e,n,r,!1)}once(t,e,n,r){return i(this,t,e,n,r,!0)}trigger(t){let e=this._handle_map[t],i=this._eventProcessor;if(e){let n=arguments,r=n.length;r>3&&(n=Array.prototype.slice.call(n,1));let s=e.length;for(let a=0;a<s;){let s=e[a];if(i&&i.filter&&null!==s.query&&!i.filter(t,s.query))a++;else{switch(r){case 1:s.fn.call(s.ctx);break;case 2:s.fn.call(s.ctx,n[1]);break;case 3:s.fn.call(s.ctx,n[2]);break;default:s.fn.apply(s.ctx,n)}s.one?(e.splice(a,1),e.length--):a++}}}return i&&i.afterTigger&&i.afterTigger(t),this}}var dt=32,pt=7;class _t extends ft{constructor(){super(),this.ele_map=new Map,this.ele_ary=[],this.ele_ary_len=0}addToRoot(t){this.addToStorage(t)}addToStorage(t){return this.ele_map.set(t.id,t),this}getDisplayList(t,e=!1){return t&&this.updateDisplayList(e),this.ele_ary}updateDisplayList(t){this.ele_map.forEach((e,i,n)=>{this._updateAndAddDisplayable(e,null,t)}),f(this.ele_ary,(t,e)=>{if(t.hLevel===e.hLevel)return t.z===e.z?t.z2-e.z2:t.z-e.z;return t.hLevel-e.hLevel})}_updateAndAddDisplayable(t,e,i){t.ignore&&!i||(t.__dirty&&t.updateTransform(),this.ele_ary[this.ele_ary_len++]=t)}}var gt=1;"undefined"!=typeof window&&(gt=Math.max(window.devicePixelRatio||1,1));var yt=gt;class mt{constructor(t,e,i,n,r){Object.assign(this,{root:t,width:e,height:i,dpr:n,id:r}),this.ctx=null;let s=null;t&&t.nodeName&&"CANVAS"===t.nodeName.toUpperCase()?s=t:"string"==typeof t?s=d(r,e,i,n):this.ctx=t,s&&s.style&&(s.onselectstart=(()=>!1),s.style["-webkit-user-select"]="none",s.style["user-select"]="none",s.style["-webkit-touch-callout"]="none",s.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",s.style.padding=0,s.style.margin=0,s.style["border-width"]=0),this.canvasDOM=s,this.hiddenCanvas=null,this.hiddenContext=null,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.__dirty=!0,this.__used=!1,this.__drawIndex=0,this.__startIndex=0,this.__endIndex=0,this.incremental=!1}initContext(){this.canvasDOM&&(this.ctx=p(this.canvasDOM)),this.ctx.dpr=this.dpr}creatHiddenCanvas(){this.hiddenCanvas=d("back-"+this.id,this.width,this.height,this.dpr),this.hiddenContext=p(this.hiddenCanvas),1!==this.dpr&&this.hiddenContext.scale(this.dpr,this.dpr)}getElementCount(){return this.__endIndex-this.__startIndex}resize(t,e){this.canvasInstance&&(this.canvasInstance.style&&(this.canvasInstance.style.width=t+"px",this.canvasInstance.style.height=e+"px"),this.canvasInstance.width=t*this.dpr,this.canvasInstance.height=e*this.dpr,this.hiddenCanvas&&(this.hiddenCanvas.width=t*this.dpr,this.hiddenCanvas.height=e*this.dpr,1!==this.dpr&&this.hiddenContext.scale(this.dpr,this.dpr)))}clear(t,e){e=e||this.clearColor,this.dpr,this.ctx.clearRect(0,0,this.width,this.height)}}let vt="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)};class xt{constructor(t,e,i={}){if(this.opts=Object.assign({},i),this.root=t,this.storage=e,this.type="canvas",this.dpr=this.opts.devicePixelRatio||yt,this.layers_map={},this.layer_id_list=[],this._layerConfig={},this._needsManuallyCompositing=!1,this._singleCanvas=!this.root.nodeName||"CANVAS"===this.root.nodeName.toUpperCase(),this._singleCanvas){let e=this.root.width,i=this.root.height;this.opts.width&&(this._width=e=this.opts.width),this.opts.height&&(this._height=i=this.opts.height),this.root.width=this.dpr*e,this.root.height=this.dpr*i;let n=new mt(this.root,this._width,this._height,this.dpr,314159);n.__builtin__=!0,this.layers_map[314159]=n,this.layer_id_list.push(314159),this._root=t}else{this._width=g(this.root,"width",this.opts),this._height=g(this.root,"height",this.opts);let t=_(this._width,this._height);this._root=t,this.root.appendChild(t)}}refresh(t){let e=this.storage.getDisplayList(!0);this._redrawId=Math.random(),this._paintList(e,t,this._redrawId);let i=this.layer_id_list;for(let t=0;t<i.length;t++){let e=i[t],n=this.layers_map[e];if(!n.__builtin__&&n.refresh){let e=0===t?this._backgroundColor:null;n.refresh(e)}}return this}_paintList(t,e,i){if(this._redrawId===i&&(e=e||!1,this._updateLayerStatus(t),!this._doPaintList(t,e))){let n=this;vt(function(){n._paintList(t,e,i)})}}_updateLayerStatus(t){function e(t){i&&(i.__endIndex!==t&&(i.__dirty=!0),i.__endIndex=t)}this._eachBuiltinLayer(function(t,e){t.__dirty=t.__used=!1});let i=null,n=0;for(let r=0;r<t.length;){let s=t[r],a=s.hLevel,o=this.getLayer(a+0,this._needsManuallyCompositing);o!==i&&(o.__used=!0,o.__startIndex!==r&&(o.__dirty=!0),o.__startIndex=r,o.incremental?o.__drawIndex=-1:o.__drawIndex=r,e(r),i=o),s.__dirty&&(o.__dirty=!0,o.incremental&&o.__drawIndex<0&&(o.__drawIndex=r)),n=++r}e(n),this._eachBuiltinLayer(function(t,e){!t.__used&&t.getElementCount()>0&&(t.__dirty=!0,t.__startIndex=t.__endIndex=t.__drawIndex=0),t.__dirty&&t.__drawIndex<0&&(t.__drawIndex=t.__startIndex)})}_eachBuiltinLayer(t,e){if(this.layer_id_list.length){let i,n=this.layer_id_list;for(let r=0;r<n.length;r++){let s=n[r];(i=this.layers_map[s]).__builtin__&&t.call(e,i,s)}}}getLayer(t,e){this._singleCanvas&&!this._needsManuallyCompositing&&(t=314159);let i=this.layers_map[t];return i||((i=new mt("hr_"+t,this._width,this._height,this.dpr)).levelId=t,i.__builtin__=!0,e&&(i.virtual=e),this.insertLayer(t,i),i.initContext()),i}insertLayer(t,e){let i=this.layers_map,n=this.layer_id_list,r=n.length,s=null,a=-1;if(i[t])return void console.log("Zlevel"+t+"has been used already");if(r>0&&t>n[0]){for(let e=0;e<r-1;e++)if(n[e]<t&&n[e+1]>t){a=e;break}s=i[n[a]]}if(n.splice(a+1,0,t),i[t]=e,!e.virtual)if(s){let t=s.canvasDOM;t.nextSibling?this._root.insertBefore(e.canvasDOM,t.nextSibling):this._root.appendChild(e.canvasDOM)}else this._root.firstChild?this._root.insertBefore(e.canvasDOM,this.root.firstChild):this._root.appendChild(e.canvasDOM)}_doPaintList(t,e){let i=[];for(let t=0;t<this.layer_id_list.length;t++){let n=this.layer_id_list[t],r=this.layers_map[n];r.__builtin__&&r!==this.__hoverlayer&&(r.__dirty||e)&&i.push(r)}let n=!0;for(let r=0;r<i.length;r++){let s=i[r],a=s.ctx,o={};a.save();let h=e?s.__startIndex:s.__drawIndex,l=!e&&s.incremental&&Date.now,u=l&&Date.now(),c=s.hLevel===this.layer_id_list[0]?this._backgroundColor:null;if(s.__startIndex===s.__endIndex)s.clear(!1,c);else if(h===s.__startIndex){let i=t[h];i.incremental&&!e||s.clear(!1,c)}-1===h&&(console.log("for some unknow reason.  drawIndex is -1"),h=s.__startIndex);let f=h;for(;f<s.__endIndex;f++){let i=t[f];if(this._doPaintEl(i,s,e,o),i.__dirty=i.__dirtyText=!1,l){let t=Date.now()-u;if(t>15)break}}return s.__drawIndex=f,s.__drawIndex<s.__endIndex&&(n=!1),o.prevElClipPaths&&a.restore(),a.restore(),n}}_doPaintEl(t,e,i,n){let r=e.ctx,s=t.transform;!e.__dirty&&!i||t.invisible||0===t.style.opacity||s&&!s[0]&&!s[3]||(t.beforeBrush&&t.beforeBrush(r),t.brush(r,n.prevEl||null),n.prevEl=t,t.afterBrush&&t.afterBrush(r))}refreshHover(){if(this._hoverElements.length){let t=this._hoverlayer;t||(t=this._hoverlayer=this.getLayer(1e5))}}}class wt extends ft{constructor(t){super(),this._running=!1,this._startTime=0,this._pause={startTime:0,flag:!1,duration:0},this._animatableMap=new Map}start(){this._startTime=(new Date).getTime(),this._pause.duration=0,this._startLoop()}pause(){this._pause.flag||(this._pause.startTime=(new Date).getTime(),this._pause.flag=!0)}_startLoop(){function t(){e._running&&(vt(t),!e._pause.flag&&e._update())}let e=this;this._running=!0,vt(t)}_update(){let t=(new Date).getTime()-this._pause.duration,e=t-this._startTime;this._animatableMap.forEach((i,n,r)=>{let s=i.animationProcessList[0];if(!s)return void this.removeAnimatable(i);s.nextFrame(t,e)}),this._startTime=t,this.trigger("frame")}resume(){this._pause.flag&&(this._pause.duration+=(new Date).getTime()-this._pause.startTime,this._pause.flag=!1)}addAnimatable(t){this._animatableMap.set(t.id,t)}removeAnimatable(t){this._animatableMap.delete(t.id)}clear(){this._animatableMap.forEach(t=>{t.stopAnimation()})}}if(!ut.canvasSupported)throw new Error("Need Canvas Environment");let bt={},kt={canvas:xt};class Mt{constructor(t,i={}){this.id=e(),this.root=t;let n=this,r=i.render;r&&kt[r]||(r="canvas"),this.storage=new _t,this.painter=new kt[r](this.root,this.storage,i,this.id),this.root.moveTo,this.watchAnim=new wt,this.watchAnim.on("frame",function(){n.flush()}),this.watchAnim.start(),this._needRefresh=!1}flush(){this._needRefresh&&this.refreshImmediately(),this._needRefreshHover&&this.refreshHoverImmediaterly()}getId(){return this.id}add(t){t.__hr=this,this.storage.addToRoot(t),this.refresh()}refresh(){this._needRefresh=!0}remove(t){this.refresh()}refreshImmediately(){this._needRefresh=this._needRefreshHover=!1,this.painter.refresh(),this._needRefresh=this._needRefreshHover=!1}refreshHoverImmediaterly(){this._needRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()}dispose(){this.watchAnim.clear(),this.storage.dispose(),this.painter.dispose(),this.watchAnim=null,this.storage=null,this.painter=null,delete bt[this.id]}}var It=function(){this.head=null,this.tail=null,this._len=0},Ot=It.prototype;Ot.insert=function(t){var e=new Tt(t);return this.insertEntry(e),e},Ot.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},Ot.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--},Ot.len=function(){return this._len},Ot.clear=function(){this.head=this.tail=null,this._len=0};var Tt=function(t){this.value=t,this.next,this.prev},Ct=function(t){this._list=new It,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null},Pt=Ct.prototype;Pt.put=function(t,e){var i=this._list,n=this._map,r=null;if(null==n[t]){var s=i.len(),a=this._lastRemovedEntry;if(s>=this._maxSize&&s>0){var o=i.head;i.remove(o),delete n[o.key],r=o.value,this._lastRemovedEntry=o}a?a.value=e:a=new Tt(e),a.key=t,i.insertEntry(a),n[t]=a}return r},Pt.get=function(t){var e=this._map[t],i=this._list;if(null!=e)return e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value},Pt.clear=function(){this._list.clear(),this._map={}};var St={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},At=new Ct(20),Dt=null;let Lt="undefined"==typeof Float32Array?Array:Float32Array;var Ft=5e-5;tt.prototype={constructor:tt,needLocalTransform(){return et(this.rotation)||et(this.position[0])||et(this.position[1])||et(this.scale[0]-1)||et(this.scale[1]-1)},updateTransform(){let t=this.parent,e=t&&t.transform,i=this.needLocalTransform(),n=this.transform;if(!i&&!e)return void(n&&U(n));n=n||K(),i?n=this.getLocalTransform(n):U(n),this.transform=n,this.invTransform=this.invTransform||K(),J(this.invTransform,n)},setTransform(t){let e=this.transform,i=t.dpr||1;e?t.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):t.setTransform(i,0,0,i,0,0)},getLocalTransform(t=[]){U(t);let e=this.origin,i=this.scale||[1,1],n=this.rotation||0,r=this.position||[0,0];return e&&(t[4]-=e[0],t[5]-=e[1]),Z(t,t,i),n&&$(t,t,n),e&&(t[4]+=e[0],t[5]+=e[1]),t[4]+=r[0],t[5]+=r[1],t}};let Rt=Math.PI,qt={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Rt/2)},sinusoidalOut:function(t){return Math.sin(t*Rt/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Rt*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Rt),-i*Math.pow(2,10*(t-=1))*Math.sin(2*Rt*(t-e)/.4))},elasticOut:function(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Rt),i*Math.pow(2,-10*t)*Math.sin(2*Rt*(t-e)/.4)+1)},elasticInOut:function(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Rt),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin(2*Rt*(t-e)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin(2*Rt*(t-e)/.4)*.5+1)},backIn:function(t){let e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){let e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){let e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-qt.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*qt.bounceIn(2*t):.5*qt.bounceOut(2*t-1)+.5}};class Et{constructor(t){this._target=t.target,this._lifeTime=t.lifeTime||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}nextFrame(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)return void(this._pausedTime+=e);let i=(t-this._startTime-this._pausedTime)/this._lifeTime;if(!(i<0)){i=Math.min(i,1);let e=this.easing,n="string"==typeof e?qt[e]:e,r="function"==typeof n?n(i):i;return this.fire("frame",r),1===i?this.loop?(this.restart(t),"restart"):"destroy":i}}restart(t){let e=(t-this._startTime-this._pausedTime)%this._lifeTime;this._startTime=t-e+this.gap,this._pausedTime=0}fire(t,e){this[t="on"+t]&&this[t](this._target,e)}}class Bt{constructor(t){this._target=t._target,this._delay=t._delay,this.isFinished=!1,this.keyFrames=[],this.timeline}addKeyFrame(t){this.keyFrames.push(t)}start(t,e=!1,i="",n=!1){let r=this._parseKeyFrames(i,t,e,n);if(!r)return null;let s=new Et(r);this.timeline=s}nextFrame(t,e){if(this.timeline){let i=this.timeline.nextFrame(t,e);return A(i)&&"destroy"===i&&(this.isFinished=!0),i}}stop(t){t&&this.timeline.onframe(this._target,1)}fire(t,e){this.timeline.fire(t,e)}_parseKeyFrames(t,e,i,n){let r=this._target,s="spline"===t,a=this.keyFrames.length;if(a){let o=z(this.keyFrames[0].value),h=!1,l=!1,u=o?j(this.keyFrames):0;this.keyFrames.sort((t,e)=>t.time-e.time);let c,f=this.keyFrames[a-1].time,d=[],p=[],_=!1;for(let t=0;t<a;t++){d.push(this.keyFrames[t].time/f);let e=this.keyFrames[t].value;if(c=t>0?this.keyFrames[t-1].value:[],o&&N(e,c,u)&&(o||e===c)||(_=!1),"string"==typeof e){let t=C(e);t?(e=t,h=!0):l=!0}p.push(e)}if(n||!_){let n=p[a-1];for(let t=0;t<a;t++)o?H(p[t],n,u):isNaN(p[t]&&!isNaN(n)&&!l&&!h)&&(p[t]=n);o&&H(r[e],n,u);let c,_,g,y,m,v,x=0,w=0,b=[0,0,0,0],k=function(t,i){let n;if(i<0)n=0;else if(i<w)for(n=c=Math.min(x+1,a-1);n>=0&&!(a[n]<=i);n--)n=Math.min(n,a-2);else{for(n=x;n<a&&!(d[n]>i);n++);n=Math.min(n-1,a-2)}x=n,w=i;let r=d[n+1]-d[n];if(0!==r)if(_=(i-d[n])/r,s)if(y=p[n],g=p[0===n?n:n-1],m=p[n>a-2?a-1:n+1],v=p[n>a-3?a-1:n+2],o)Y(g,y,m,v,_,_*_,_*_*_,t[e],u);else{let i;if(h)i=Y(g,y,m,v,_,_*_,_*_*_,b,1),i=X(b);else{if(l)return W(y,m,_);i=V(g,y,m,v,_,_*_,_*_*_)}t[e]=i}else if(o)if(p[n]){let i=G(p[n],p[n+1],_,t[e],u);console.log(i)}else console.log(p,"---",n);else{let i;if(h)G(p[n],p[n+1],_,b,1),i=X(b);else{if(l)return W(p[n],p[n+1],_);i=Q(p[n],p[n+1],_)}console.log(i),t[e]=i}};return{target:r,lifeTime:f,loop:i,delay:this._delay,onframe:k,easing:t&&"spline"!==t?t:"Linear"}}}}}class zt{constructor(t,e){this._trackCacheMap=new Map,this._target=t,this._loop=e||!1,this._delay=0,this._running=!1,this._paused=!1,q(this,ft,this.opts)}when(t,e){for(let i in e)if(e.hasOwnProperty(i)){let n=this._target[i];if(null!==n&&void 0!==n){let r=this._trackCacheMap.get(i);if(r||(r=new Bt({_target:this._target,_delay:this._delay})),0!==t){let t=r.keyFrames.length&&r.keyFrames[0];t||r.addKeyFrame({time:0,value:n})}return r.addKeyFrame({time:t,value:e[i]}),this._trackCacheMap.set(i,r),this}}}start(t=!1,e="",i=!1){this._running=!0,this._paused=!1;let n=[...this._trackCacheMap.keys()];return console.log(n),n.length?(n.forEach((n,r)=>{let s=this._trackCacheMap.get(n);s&&s.start(n,t,e,i)}),this):(this.trigger("done"),this)}nextFrame(t,e){this._running=!0,this._paused=!1;let i="";[...this._trackCacheMap.values()].forEach((n,r)=>{let s=n.nextFrame(t,e);A(s)||D(s)&&(i=s)}),D(i)&&this.trigger("during",this._target,i),this.isFinished()&&this.trigger("done")}stop(t){return this._running=!1,this._paused=!1,[...this._trackCacheMap.values()].forEach((t,e)=>{t.stop(this._target,1)}),this._trackCacheMap=new Map,this.trigger("stop"),this}during(t){return this.on("during",t),this}isFinished(){let t=!0;return[...this._trackCacheMap.values()].forEach((e,i)=>{e.isFinished||(t=!1)}),t}}B(zt.prototype,ft.prototype);let jt=function(){this.animationProcessList=[]};jt.prototype={animate:function(t,e){let i=this;if(t){let e=t.split(".");console.log(e),console.log(this);for(let t=0;t<e.length;t++){let n=e[t];if(this[n]){i=this[n];break}}}let n=new zt(i);return n.during(()=>{this.dirty()}),n.on("done",()=>{this.removeAnimationProcess(n)}),n.on("stop",()=>{this.removeAnimationProcess(n)}),this.animationProcessList.push(n),this.__hr&&this.__hr.watchAnim.addAnimatable(this),n},removeAnimationProcess:function(t){let e=this.animationProcessList.indexOf(t);e>=0&&this.animationProcessList.splice(e,1)},stopAnimation:function(t=!1){return this.animationProcessList.forEach((e,i)=>{e.stop(t)}),this.animationProcessList.length=0,this}};let Nt=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];it.prototype={constructor:it,fill:"#000",stroke:null,opacity:1,fillOpacity:null,strokeOPacity:null,strokeNoScale:!1,lineDash:null,lineDashOffset:0,shadowblur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontFamily:null,textTag:null,textFill:"#000",textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:0,textRotation:0,textOrigin:null,textBorderColor:null,textBackgroundColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,i){let n=i&&i.style,r=!n||!1===t._stylehasChanged;if((r||this.fill!==n.fill)&&(t.fillStyle=this.fill),(r||this.stroke!==n.stroke)&&(t.strokeStyle=this.stroke),(r||this.opacity!==n.opacity)&&(t.globalAlpha=null==this.opacity?1:this.opacity),(r||this.blend!==n.blend)&&(t.globalCompositeOperation=this.blend||"source-over"),this.hasStroke()){let i=this.lineWidth,n=this.strokeNoScale&&e&&e.getLineScale();t.lineWidth=i/(n||1)}t._stylehasChanged=!0},hasFill:function(){let t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){let t=this.stroke;return null!=t&&"none"!==t&&this.lineWidth>0},getBoundingRect:function(){},set:function(){},clone:function(){}};let Ht=it.prototype;for(let t=0;t<Nt.length;t++){let e=Nt[t];!e[0]in Ht&&(Ht[e[0]]=e[1])}class Wt{constructor(t={}){this.opts=t,this.id="el-"+e(),this.type="element",this.name="",this.parent=null,this.ignore=!1,this.clipPath=null,this.calculateTextPosition=null,this.invisible=!1,this.z=0,this.hLevel=0,this.draggalbe=!1,this.dragging=!1,this.slient=!1,this.cursor="pointer",this.rectHover=!1,this.progressive=!1,this.incremental=!1,this.globalScaleRatio=1,this.animationProcessList=[],this.__hr=null,this.__dirty=!0,this._rect=null,this.__clipPaths=null,this.style=new it(this.opts.style,this),this.shape={};let i=this.opts.shape;if(i)for(let t in i)!this.shape.hasOwnProperty(t)&&i.hasOwnProperty(t)&&(this.shape[t]=i[t]);q(this,tt,this.opts),q(this,ft,this.opts),q(this,jt,this.opts),E(this,this.opts,["style","shape"])}attr(t,e){if("[Object String]"===L(t))this._setProp(t,e);else if(S(t))for(let e in t)t.hasOwnProperty(e)&&this._setProp(e,t[e]);this.dirty()}_setProp(t,e){switch(t){case"style":E(this.style,e);break;case"positon":case"scale":case"origin":case"skew":case"translate":let i=this[t]?this[t]:[];i[0]=e[0],i[1]=e[1];default:this[t]=e}}}B(Wt.prototype,jt.prototype,tt.prototype,ft.prototype);var Gt={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7};nt.prototype={constructor:nt,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,getContext:function(){return this._ctx},beginPath:function(t){return this._ctx=t,t&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(Gt,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){let i=Math.abs(t-this.xi)>this._ux||Math.abs(e-this._yi)>this._uy||this._len<5;return i&&(this._xi=t,this._yi=e),this._ctx&&i&&this._ctx.lineTo(t,e),this},arc:function(t,e,i,n,r,s){return this._ctx&&this._ctx.arc(t,e,i,n,r,s),this._xi=Math.cos(r)*i+t,this._yi=Math.sin(r)*i+e,this},bezierCurveTo:function(t,e,i,n,r,s){return this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,i,n,r,s):this._ctx.bezierCurveTo(t,e,i,n,r,s)),this._xi=r,this._yi=s,this},quadraticCurveTo:function(t,e,i,n){return this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this},fill:function(t){t&&t.fill()},stroke:function(t){t&&t.stroke()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t,this._dashIdx=0;let e=0;for(let i=0;i<t.length;i++)e+=e[i];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},closePath:function(){var t=this._ctx,e=this._x0,i=this._y0;return t&&t.closePath(),this._xi=e,this._yi=i,this},rect:function(t,e,i,n){return this._ctx&&this._ctx.rect(t,e,i,n),this},_needsDash:function(){return this._lineDash},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var i=0;i<arguments.length;i++)e[this._len++]=arguments[i];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}}};class Qt extends Wt{constructor(t){super(t),this.type="path",this.path=null,this.__dirtyPath=!0,this.strokeContainThreshold=5,this.segmentIgnoreThreshold=0,this.subPixelOptimize=!1}brush(t,e){let i=this.path||new nt(!0),n=this.style.hasStroke(),r=this.style.hasFill(),s=this.style.fill,a=this.style.stroke,o=r&&!!s.colorStops,h=n&&!!a.colorStops,l=(r&&s.image,n&&a.image,!!t.setLineDash),u=this.style.lineDash,c=this.style.lineDashOffset;if(this.style.bind(t,this,e),this.setTransform(t),this.__dirty){let e;o&&(e=e||this.getBoundingRect(),this._fillGradient=this.style.getBoundingRect(t,s,e)),h&&(e=e||this.getBoundingRect(),this.__strokeGradient=this.style.getBoundingRect(t,a,e))}o&&(t.fillStyle=this.__fillGradient),h&&(t.strokeStyle=this.__strokeGradient),h&&(t.strokeStyle=this._strokeGradient),this.__dirtyPath?(i.beginPath(t),u&&l&&(t.setLineDash(u),t.lineDashOffset=c),this.buildPath(i,this.shape,!1),this.path&&(this.__dirtyPath=!1)):t.beginPath(),r&&i.fill(t),n&&i.stroke(t),u&&l&&t.setLineDash([])}dirty(){this.__dirty=this.__dirtyText=!0,this.__hr&&this.__hr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()}getLineScale(){let t=this.transform;return t&&Math.abs(t[0]-1)>1e-10&&Math.abs(t[3]-1)>1e-10?Math.sqrt(Math.abs(t[0]*t[3]-t[2]*t[1])):1}}class Vt extends Qt{constructor(t){super(R({shape:{r:0,x:0,y:0,width:0,height:0}},t,!0)),this.type="rect"}buildPath(t,e){let i,n,r,s;this.subPixelOptimize||(i=e.x,n=e.y,r=e.width,s=e.height),e.r?v(t,e):t.rect(i,n,r,s),t.closePath()}}let Xt={shape:{cx:0,cy:0,r:0}};class Yt extends Qt{constructor(t){super(R(Xt,t,!0)),this.type="circle"}buildPath(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}}let Kt={shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:null,fill:null}};class Ut extends Qt{constructor(t){super(R(Kt,t,!0)),this.type="arc"}buildPath(t,e){let i=e.cx,n=e.cy,r=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,o=e.clockwise;t.arc(i,n,r,s,a,!o)}}let Zt={shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:null,fill:null}};class $t extends Qt{constructor(t){super(R(Zt,t,!0)),this.type="arc"}buildPath(t,e){let i=e.cx,n=e.cy,r=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,o=e.clockwise;t.moveTo(i,n),t.arc(i,n,r,s,a,!o),t.closePath()}}let Jt={shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null}};class te extends Qt{constructor(t){super(R(Jt,t,!0)),this.type="arc"}buildPath(t,e){let i,n,r,s;if(this.subPixelOptimize){let t={};rt(t,e,this.style),i=t.x1,r=t.y1,n=t.x2,s=t.y2}else i=e.x1,r=e.y1,n=e.x2,s=e.y2;let a=e.percent;0!==a&&(t.moveTo(i,r),a<1&&(n=i*(1-a)+n*a,s=r*(1-a)+s*a),t.lineTo(n,s))}}let ee={shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null,lineDash:[5,10,15],lineDashOffset:0}};class ie extends Qt{constructor(t){super(R(ee,t,!0)),this.type="arc"}buildPath(t,e){let i,n,r,s;if(this.subPixelOptimize){let t={};rt(t,e,this.style),i=t.x1,r=t.y1,n=t.x2,s=t.y2}else i=e.x1,r=e.y1,n=e.x2,s=e.y2;let a=e.percent;0!==a&&(t.moveTo(i,r),a<1&&(n=i*(1-a)+n*a,s=r*(1-a)+s*a),t.lineTo(n,s))}}var ne="undefined"==typeof Float32Array?Array:Float32Array;at(),at(),at();let re={shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null}},se=[];class ae extends Qt{constructor(t){super(R(re,t,!0)),this.type="bezier-curve"}buildPath(t,e){let i=e.x1,n=e.y1,r=e.x2,s=e.y2,a=e.cpx1,o=e.cpy1,h=e.cpx2,l=e.cpy2,u=e.percent;0!==u&&(t.moveTo(i,n),null==h||null==l?(u<1&&(ht(i,a,r,u,se),a=se[1],r=se[2],ht(n,l,s,u,se),o=se[1],s=se[2]),t.quadraticCurveTo(a,o,r,s)):(u<1&&(ot(i,a,h,r,u,se),a=se[1],h=se[2],r=se[3],ot(n,o,l,s,u,se),o=se[1],l=se[2],s=se[3]),t.bezierCurveTo(a,o,h,l,r,s)))}}t.Arc=Ut,t.BezierCurve=ae,t.Circle=Yt,t.Line=te,t.LineDash=ie,t.Rect=Vt,t.Sector=$t,t.dispose=m,t.init=y,t.version="1.0.0",Object.defineProperty(t,"__esModule",{value:!0})});
